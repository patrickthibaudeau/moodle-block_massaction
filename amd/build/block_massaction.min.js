define ("block_massaction/block_massaction",["jquery","core/str"],function(a,b){return{init:function init(b){this.data=b;this.drawCheckboxes(this.data);this.populateMenus(this.data);a("#block-massaction-selectall").on("click",this.data,this.selectAllHandler);a("#block-massaction-selectsome").on("change",this.data,this.selectAllHandler);a("#block-massaction-selectnone").on("click",this.data,this.selectAllHandler);a("#block-massaction-outdent").on("click",this.data,this.actionHandler);a("#block-massaction-indent").on("click",this.data,this.actionHandler);a("#block-massaction-hide").on("click",this.data,this.actionHandler);a("#block-massaction-show").on("click",this.data,this.actionHandler);a("#block-massaction-delete").on("click",this.data,this.actionHandler);a("#block-massaction-move").on("change",this.data,this.actionHandler);a("#block-massaction-clone").on("change",this.data,this.actionHandler)},drawCheckboxes:function drawCheckboxes(b){var c="",d="",e="",f=0,g=0;for(g in b.sectionmodules){if(null!==g&&0!==a("#section-"+g).length){e=g+" ul.section li.activity div.mod-indent-outer div";c=a("#section-"+e).children(".actions");for(var h=0;h<b.sectionmodules[g].length;h++){f=b.sectionmodules[g][h];d=document.createElement("input");d.type="checkbox";d.id="massaction-input-"+f;d.className="massaction-checkbox";if(document.body.contains(c[h])){c[h].appendChild(d)}}}}},populateMenus:function populateMenus(b){var c=["block-massaction-selectsome","block-massaction-move","block-massaction-clone"],d=0,e="",f=0;for(f in b.sectionnames){for(d in c){e=document.createElement("option");e.text=b.sectionnames[f];e.value=f;if("block-massaction-selectsome"===c[d]){if(f in b.sectionmodules){e.disabled=!1}else{e.disabled=!0}}else{e.disabled=!1}a("#"+c[d]).append(e)}}},selectAllHandler:function selectAllHandler(b){var c=!1,d=!1,e=!1,f="",g="",h="";switch(b.currentTarget.id){case"block-massaction-selectsome":e=!0;case"block-massaction-selectnone":d=!0;a("#block-massaction-selected-all").val("false");case"block-massaction-selectall":if(!d){c=!0;a("#block-massaction-selected-all").val("true")}for(f in b.data.sectionmodules){for(h in b.data.sectionmodules[f]){g=b.data.sectionmodules[f][h];if(0<a("#massaction-input-"+g).length){a("#massaction-input-"+g).prop("checked",c)}}}if(!0===e){f=b.target.value;for(h in b.data.sectionmodules[f]){g=b.data.sectionmodules[f][h];if(0<a("#massaction-input-"+g).length){a("#massaction-input-"+g).prop("checked",!0)}}}else{a("#block-massaction-selectsome").val("all")}break;}},actionHandler:function actionHandler(c){var d=[],e=0,f=c.data.courseformat,g="",h=null,i=0,j=a("#block-massaction-selectsome").val(),k="";if("onetopic"===f){var l=a("li.active:eq(0)"),m=l[0].textContent,n=a("li[aria-label='"+m+"']").attr("id");n=n.split("-");e=n[1]}a("#block-massaction-selected-section").val(j);var o=c.currentTarget.id.split("-"),p=o[o.length-1];switch(j){case"all":for(j in c.data.sectionmodules){for(h in c.data.sectionmodules[j]){g=c.data.sectionmodules[j][h];if(("onetopic"===f&&e===j||"onetopic"!==f)&&0<a("#massaction-input-"+g).length&&a("#massaction-input-"+g).is(":checked")){d.push(g)}else if("true"===a("#block-massaction-selected-all").val()&&"onetopic"===f&&e!==j){d.push(g)}}}break;default:for(h in c.data.sectionmodules[j]){g=c.data.sectionmodules[j][h];if(("onetopic"===f&&e===j||"onetopic"!==f)&&0<a("#massaction-input-"+g).length&&a("#massaction-input-"+g).is(":checked")){d.push(g)}else if("onetopic"===f&&e!==j){d.push(g)}}}i=d.length;switch(p){case"delete":if(0<i){var q=b.get_string("confirmation","block_massaction",i);a.when(q).done(function(a){if(!window.confirm(a)){return!1}else{return!0}})}break;case"move":case"clone":k=a("#block-massaction-"+p).val();break;}a("#block-massaction-action").val(p);a("#block-massaction-activities").val(JSON.stringify(d));a("#block-massaction-target").val(k);if(0<i){a("#block-massaction-control-form").submit()}else{var r=b.get_string("noitemselected","block_massaction");a.when(r).done(function(a){window.alert(a)})}}}});
//# sourceMappingURL=block_massaction.min.js.map
